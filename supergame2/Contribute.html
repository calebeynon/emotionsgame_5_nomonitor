{{ extends "global/Page.html" }}
{{ block title }}<div style="text-align: center;">Allocate</div>{{ endblock }}
{{ block content }}
<style>
body {
  font-size: 18px; /* You can adjust this value as needed */
}

p {
  font-size: 24px;  
  line-height: 1.5; /* Improves line spacing for better readability */
}
li {
  font-size: 1em; /* Same as the body font size */
}

.balance-display {
  background-color: #f8f9fa;
  border: 2px solid #dee2e6;
  border-radius: 8px;
  padding: 15px;
  margin-left: 15px;
  min-width: 250px;
  text-align: center;
  font-weight: bold;
  color: #495057;
}

.input-container {
  display: flex;
  align-items: center;
  gap: 15px;
}
</style>
    <p>
        Please select how many tokens you would like to allocate to the Group Account.
        Remember that you have up to 25 tokens to allocate between the Private and the Group Accounts.
        You can choose as few or as many tokens to allocate to either account.
        <br>
    </p>

    <p>
        Recall here that each token in your Private Account earns you 1.0 ECU, while the formula for your share of the Group Account is:
        <div style="text-align: center;">
            <b>&frac14; x 1.6 x the total number of tokens in the Group Account</b>
        </div>
    </p>

    <div class="mb-3">
        <label for="id_contribution">{{ form.contribution.label }}</label>
        <div class="input-container">
            <div style="flex: 1; display: flex; flex-direction: column;">
                <div class="input-group">
                    <input type="number" name="contribution" id="id_contribution" class="form-control" min="0" max="25" required>
                    <span class="input-group-text">tokens</span>
                </div>
                <div id="contribution-error" style="color: #dc3545; margin-top: 6px; min-height: 1.2em;"></div>
            </div>
            <div class="balance-display">
                <div>Your private account balance would be:</div>
                <div id="private-balance" style="font-size: 20px; color: #6c757d; margin-top: 5px;">--</div>
            </div>
        </div>
    </div>

    {{ next_button }}

<script>
function updatePrivateBalance() {
    const input = document.getElementById('id_contribution');
    const balanceDisplay = document.getElementById('private-balance');
    const errorDisplay = document.getElementById('contribution-error');
    
    if (input && balanceDisplay) {
        const rawValue = input.value;

        if (rawValue === '') {
            balanceDisplay.innerHTML = '<div style="font-size: 20px; color: #6c757d; margin-top: 5px;">--</div>';
            if (errorDisplay) errorDisplay.textContent = '';
            return;
        }

        const contribution = parseFloat(rawValue);
        let errorMsg = '';
        
        // Check if input is valid (between 0 and 25 and is a whole number)
        if (isNaN(contribution) || contribution < 0 || contribution > 25) {
            errorMsg = 'please enter a number between 0 and 25';
        } else if (contribution % 1 !== 0) {
            errorMsg = 'please enter a whole number';
        }

        if (errorMsg) {
            const errorHtml = '<div style="color: #dc3545;">' + errorMsg + '</div>';
            balanceDisplay.innerHTML = errorHtml;
            if (errorDisplay) errorDisplay.textContent = errorMsg;
        } else {
            const privateBalance = 25 - contribution;
            balanceDisplay.innerHTML = '<div style="font-size: 20px; color: #007bff; margin-top: 5px;">' + privateBalance + ' tokens</div>';
            if (errorDisplay) errorDisplay.textContent = '';
        }
    }
}

// Update balance when input changes
document.addEventListener('DOMContentLoaded', function() {
    const input = document.getElementById('id_contribution');
    if (input) {
        input.addEventListener('input', updatePrivateBalance);
        
        // Update every 0.5 seconds
        setInterval(updatePrivateBalance, 500);
        
        // Initial update
        updatePrivateBalance();
    }
});
</script>

{{ endblock }}
